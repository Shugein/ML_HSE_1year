
# Домашнее задание №1 

## Описание
Обучил модель линейной регрессии для предсказания стоимости автомобилей на индийском рынке. 

## Что cделано 

### EDA 
- Загрузил данные
- Нашёл пропуски в mileage, engine, max_power, torque, seats (~200 пропусков)
- Удалил дубликаты
- Построил ydata-profiling дашборд
- Построил корреляционные матрицы Пирсон, Кендалл (своя реализация), PhiK
- Визуализации pairplot, heatmap, boxplot по категориям

### Препроцессинг 
- Извлёк числа из mileage, engine, max_power (убрал единицы измерения)
- Распарсил torque на две колонки torque и max_torque_rpm
- Конвертировал kgm в Nm для torque
- Заполнил пропуски медианой (считал только по train)
- Привёл engine и seats к int


### Добавление категориальных признаков 
- Извлёк марку из названия автомобиля
- Применил OneHotEncoding к brand, fuel, seller_type, transmission, seats
- Ridge с категориальными: R = 0.78

### Feature Engineering 
- power_per_liter = max_power / (engine / 1000)
- year_squared = year
- age = 2025 - year
- km_per_year = km_driven / age
- log_km = log(km_driven)
- is_first_owner = бинарный признак
- Логарифм цены y_train_log = log1p(y_train)
- RobustScaler вместо StandardScaler

**Итог Ridge (FE + log + Robust) = R = 0.91

### Бизнес-метрики 
1. business_metric  доля прогнозов с ошибкой <=10%
   - LinearRegression 24%
   - Ridge категориальные 30.5%
   - Ridge F 35.7%

2. potential_loss сумма недопрогнозов
   - LinearRegression 94.4
   - Ridge категориальные 68.7
   - Ridge FE 56.4

## Что помогло больше всего
1. Логарифм цены +0.13 к R
2. Категориальные признаки +0.18 к R
3. Feature Engineering +0.13 к R


## Что не зашло
- Долго считалось собственная реализация кедналаа
- Сдох профиль для дашборда и отказыватеся открываться

## Оценка сервиса

### Ссылка на сервис
hseml1year2025-8snmjfub9beg3kqsespti2 https://hseml1year2025-8snmjfub9beg3kqsespti2.streamlit.app/

### Удобство использования
Приложение простое, три вкладки: EDA, предсказание, веса. Можно вводить данные вручную или загрузить CSV.

### Что получилось хорошо
- Графики интерактивные (plotly)
- Предсказание работает быстро
- Веса наглядно показаны

### Что менее удачно
- Нет валидации ввода
- При загрузке CSV нужен определённый формат

### Ограничения и проблемы
- Не все марки авто есть в обучающей выборке, для новых марок предсказание менее точное
- При экстремальных значениях (очень старые или дорогие авто) качество падает

### Планы на улучшение
- Добавить валидацию входных данных
- Попробовать градиентный бустинг для сравнения
- Попробовать дать выбор пользователю модели предсказания
- Поробовать визуализацию нескольких моделей на одном графике
